<html>

  <head>

    <title>Battle | Ship</title>
    <style type="text/css">BODY {background-image: url(background.gif);}</style>
    <link href="css/main.css" type="text/css" rel="stylesheet"></link>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/underscore.min.js"></script>

  </head>


  <body>

    <div id="startup">

      <button id="start_button">START</button>

      <div id="game_options">
        <select></select>
        <br/>
        <a href="#" class="btn submit">Submit</a>
      </div>

    </div>

    <div id="grid">
      
      <div id="user_side" class="user-side"><h1>You</h1></div>

      <div id="machine_side" class="machine-side"><h1>The Machine</h1></div>

      
        <!--Refactor-->

        <script type="text/javascript">
          $(document).ready(function(event){
            var selectValues;

            $("#start_button").click(function(event){
              selectValues = {
                easy: {
                  title:"Easy",
                  grid_size: 10
                },

                medium: {
                  title: "Medium",
                  grid_size: 15
                },

                hard: {
                  title: "Hard",
                  grid_size: 20
                },

                impossible: {
                  title:"Impossible",
                  grid_size: 30
                }
              }

              $.each(selectValues, function(key, value){
                option = $("<option/>")
                option.val(key)
                option.text(value.title)


                $("#game_options select").append(option);
                $("#game_options").fadeIn();

                //additions

                $("#start_button").fadeOut();



              })

            })

            game_handlers = (function(){$(".grid-cell").click(function(event){
              var x = $(this).data("x");
              var y = $(this).data("y");
              var total_possible_hits = machine_ship.size;


              match = _.find(machine_ship.cells, function(cell){
                return($(cell).data("x") == x && $(cell).data("y") == y);
              })


              if($(this).hasClass("user-grid-cell")==true) {
                alert('wrong board, dummy')

              } else if($(this).hasClass("hit-cell")) {
                alert('you already fired there, moron');

              } else if(_.isUndefined(match)) {
                alert('miss!')

              } else {
                alert('hit!')
                machine_ship.add_hit_cell(match)
                $(this).addClass('hit-cell')
              }

              if(total_possible_hits == machine_ship.hit_cells.length) {
                alert('YOU SANK THE SHIP!')
                $()

                // TODO: expand for more ship = something like sunk_machine_ships.add_sunk_ship(match something unique like name from each ship)
              }

            })
            })

            // //additions
            $( "#game_options .submit" ).click(function( event ) {
              if ( $( "option:selected" ).val() == "easy" ) {

                start(selectValues.easy.grid_size);
                $("#game_options").fadeOut();

              } else if( $( "option:selected" ).val() == "medium" ) {

                start(selectValues.medium.grid_size);
                $("#game_options").fadeOut();

              } else if( $( "option:selected" ).val() == "hard" ) {

                start(selectValues.hard.grid_size);
                $("#game_options").fadeOut();

              } else if( $( "option:selected" ).val() == "impossible" ) {

                start(selectValues.impossible.grid_size);
                $("#game_options").fadeOut();
              }

              game_handlers();

            })

            
            
          });

        </script>

    </div>

  </body>

</html>